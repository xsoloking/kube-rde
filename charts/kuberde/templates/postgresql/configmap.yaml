{{- if .Values.postgresql.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "kuberde.fullname" . }}-postgresql-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "kuberde.postgresql.labels" . | nindent 4 }}
data:
  postgresql.conf: |
    # PostgreSQL Configuration
    max_connections = {{ .Values.postgresql.config.maxConnections }}
    shared_buffers = {{ .Values.postgresql.config.sharedBuffers }}
    effective_cache_size = {{ .Values.postgresql.config.effectiveCacheSize }}
    maintenance_work_mem = {{ .Values.postgresql.config.maintenanceWorkMem }}
    checkpoint_completion_target = {{ .Values.postgresql.config.checkpointCompletionTarget }}
    wal_buffers = {{ .Values.postgresql.config.walBuffers }}
    default_statistics_target = {{ .Values.postgresql.config.defaultStatisticsTarget }}
    random_page_cost = {{ .Values.postgresql.config.randomPageCost }}
    effective_io_concurrency = {{ .Values.postgresql.config.effectiveIoConcurrency }}
    work_mem = {{ .Values.postgresql.config.workMem }}
    min_wal_size = {{ .Values.postgresql.config.minWalSize }}
    max_wal_size = {{ .Values.postgresql.config.maxWalSize }}
    max_worker_processes = {{ .Values.postgresql.config.maxWorkerProcesses }}
    max_parallel_workers_per_gather = {{ .Values.postgresql.config.maxParallelWorkersPerGather }}
    max_parallel_workers = {{ .Values.postgresql.config.maxParallelWorkers }}
    max_parallel_maintenance_workers = {{ .Values.postgresql.config.maxParallelMaintenanceWorkers }}
{{- end }}
